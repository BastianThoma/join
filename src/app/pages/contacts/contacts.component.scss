/**
 * Contacts Component Styles
 * 
 * Implementiert BEM-Methodologie mit vollständiger Accessibility-Unterstützung
 * nach WCAG 2.1 AA Standards. Mobile-First responsive Design.
 * 
 */

// === SCSS Variables ===
$primary-color: #005dff;
$primary-hover: #4589ff;
$secondary-color: #2a3647;
$text-color: #222;
$text-muted: #42526e;
$border-color: #f1f1f1;
$background-light: #f5f8fd;
$error-color: #e74c3c;
$success-color: #27ae60;
$shadow-light: 0 2px 8px rgba(0, 0, 0, 0.1);
$shadow-medium: 0 4px 16px rgba(0, 0, 0, 0.12);
$shadow-heavy: 0 8px 32px rgba(0, 0, 0, 0.18);

// Responsive Breakpoints
$mobile: 320px;
$tablet: 768px;
$desktop: 1024px;

// === Screen Reader Utilities ===
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

// === Base Component Styles ===
.contacts {
  position: relative;
  padding: 0 0 24px 0;
  min-height: 100vh;
  background: #fff;

  // Desktop: Layout mit fester Kontaktliste und gleitender Detailansicht
  @media (min-width: 1024px) {
    display: flex;
    overflow: hidden;
  }

  &__list {
    // Mobile: Volle Breite
    width: 100%;

    // Desktop: Feste Breite für Kontaktliste
    @media (min-width: 1024px) {
      width: 350px;
      flex-shrink: 0;
      overflow-y: auto;
      height: calc(100vh - 72px);
      border-right: 1px solid $border-color;
    }

    // Größere Bildschirme: Etwas mehr Platz
    @media (min-width: 1400px) {
      width: 400px;
    }
  }

  &__header-actions {
    display: none;

    // Nur auf Desktop anzeigen
    @media (min-width: 1024px) {
      display: block;
      padding: 16px 24px;
      border-bottom: 1px solid $border-color;
    }
  }

  &__add-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    width: 100%;
    padding: 12px 16px;
    background: $primary-hover; // Gleiche Farbe wie kleiner FAB
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;

    &:hover {
      background: $primary-color; // Gleiche Hover-Farbe wie kleiner FAB
      transform: translateY(-1px);
      box-shadow: $shadow-medium;
    }

    &:active {
      transform: translateY(0);
      box-shadow: $shadow-light;
    }

    img {
      width: 20px;
      height: 20px;
      filter: brightness(0) invert(1); // Macht das Icon weiß
    }

    span {
      // Zentriert den Text
      text-align: center;
    }
  }

  &__letter {
    font-size: 20px;
    font-weight: 400;
    color: $text-muted;
    margin: 24px 0 8px 24px;
  }

  &__row {
    display: flex;
    align-items: center;
    padding: 16px 24px;
    border-bottom: 1px solid $border-color;
    background: #fff;
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;

    &:hover {
      background: $background-light;
    }

    &:active {
      background: $background-light;
    }

    // Aktiver Zustand - ähnlich wie Navbar-Links
    &--active {
      background: linear-gradient(
        90deg,
        rgba(69, 137, 255, 0.1) 0%,
        rgba(69, 137, 255, 0.05) 100%
      );
      border-left: 4px solid $primary-color;
      padding-left: 20px; // Kompensiert den Border

      // Desktop: Prominenterer aktiver Zustand
      @media (min-width: 1024px) {
        background: linear-gradient(
          90deg,
          rgba(69, 137, 255, 0.08) 0%,
          rgba(69, 137, 255, 0.02) 100%
        );
        border-radius: 0 8px 8px 0;
        margin-right: 8px;
        box-shadow: inset 3px 0 0 $primary-color,
          0 2px 8px rgba(69, 137, 255, 0.1);
        border-left: none;
        padding-left: 24px;

        &:hover {
          background: linear-gradient(
            90deg,
            rgba(69, 137, 255, 0.12) 0%,
            rgba(69, 137, 255, 0.04) 100%
          );
          transform: translateX(2px);
        }
      }

      .contacts__name {
        color: $primary-color;
        font-weight: 600;
      }

      .contacts__email {
        color: darken($primary-color, 10%);
      }

      .contacts__avatar {
        border: 2px solid $primary-color;
        box-shadow: 0 0 0 2px rgba(69, 137, 255, 0.2);
      }
    }
  }

  &__avatar {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 16px;
    font-weight: 700;
    margin-right: 16px;
    flex-shrink: 0;
  }

  &__info {
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  &__name {
    font-size: 18px;
    font-weight: 400;
    color: $secondary-color;
    margin-bottom: 2px;
  }

  &__email {
    font-size: 16px;
    color: $primary-color;
    word-break: break-all;
  }

  &__fab {
    position: fixed;
    right: 24px;
    bottom: 96px;
    width: 56px;
    height: 56px;
    border-radius: 16px;
    background: $primary-hover;
    box-shadow: $shadow-medium;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 400;
    transition: background 0.2s;

    // Desktop: FAB ausblenden, da großer Button in der Liste vorhanden ist
    @media (min-width: 1024px) {
      display: none;
    }

    img {
      width: 28px;
      height: 28px;
    }

    &:hover {
      background: $primary-color;
    }
  }
}

// === Contact Menu Component ===
.contact-menu-overlay {
  position: relative;
  inset: 0;
  background: transparent;
  z-index: 2001;
  display: flex;
  align-items: flex-start;
  justify-content: flex-end;
}

.contact-menu {
  position: absolute;
  margin: 90px 24px 0 0;
  background: #fff;
  border-radius: 20px 20px 20px 4px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.13);
  padding: 18px 24px 14px 24px;
  display: flex;
  flex-direction: column;
  gap: 18px;
  min-width: 140px;

  &__item {
    display: flex;
    align-items: center;
    gap: 12px;
    background: none;
    border: none;
    color: $secondary-color;
    font-size: 18px;
    font-weight: 500;
    cursor: pointer;
    padding: 0;
    transition: color 0.15s;

    &:hover {
      color: $primary-color;
    }

    img {
      width: 22px;
      height: 22px;
      object-fit: contain;
      filter: none;
    }
  }
}

// === Contact Detail Component ===
.contact-detail {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: calc(100vh - 72px);
  background: #fff;
  z-index: 30;
  box-shadow: 0 0 32px rgba(0, 0, 0, 0.1);
  transform: translateX(100%);
  transition: transform 0.35s cubic-bezier(0.77, 0, 0.18, 1);
  overflow-y: auto;
  pointer-events: none;
  opacity: 0;
  padding-top: 72px;

  // Desktop: Neben der Kontaktliste positionieren
  @media (min-width: 1024px) {
    left: calc(240px + 350px); // Sidebar + Kontaktliste Breite
    width: calc(
      100vw - 240px - 350px
    ); // Verfügbare Breite rechts der Kontaktliste
    padding-top: 72px;
    top: 72px; // Unter dem Header positionieren
    height: calc(100vh - 72px);

    // Animation: Von rechts nach links bis zur Kontaktliste
    transform: translateX(100%);

    &--open {
      transform: translateX(0);
    }
  }

  // Größere Bildschirme: Breitere Kontaktliste berücksichtigen
  @media (min-width: 1400px) {
    left: calc(240px + 400px);
    width: calc(100vw - 240px - 400px);
  }

  &--open {
    transform: translateX(0);
    pointer-events: auto;
    opacity: 1;
  }

  &__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 16px 0 16px;
    min-height: 48px;
    position: relative;
    z-index: 10;
  }

  &__title {
    font-size: 18px;
    font-weight: 700;
    color: #000;
  }

  &__close {
    background: none;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 20;
    position: relative;

    img {
      width: 28px;
      height: 28px;
      display: block;
      content: url("/assets/img/arrow_left.png");
      transition: filter 0.2s;
    }

    &:hover img {
      content: url("/assets/img/arrow_left_hover.png");
    }
  }

  &__main {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    margin: 10px 10px 0 16px;
  }

  &__header-info {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 16px;
    width: 100%;
  }

  &__avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 24px;
    font-weight: 700;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border: 3px solid #fff;
    flex-shrink: 0; // Verhindert, dass der Avatar schrumpft
  }

  &__name {
    font-size: 24px;
    font-weight: 400;
    color: #222;
    margin: 0; // Entfernt den Standard-Margin
  }

  &__info {
    display: flex;
    flex-direction: column;
    gap: 8px;
    width: 100%;
  }

  &__label {
    font-size: 15px;
    font-weight: 700;
    color: #000;
    margin-bottom: 2px;
  }

  &__email {
    font-size: 15px;
    color: $primary-color;
    margin-bottom: 8px;
    word-break: break-all;
  }

  &__phone {
    font-size: 15px;
    color: #222;
  }

  // Contact Actions Buttons für Desktop Detail View
  &__actions {
    display: flex;
    gap: 12px;
    margin-top: 24px;
    padding-top: 16px;
    border-top: 1px solid #f0f0f0;

    @media (max-width: 1023px) {
      display: none; // Nur auf Desktop anzeigen, da Mobile FAB Menu verwendet
    }
  }

  &__action-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 16px;
    border: 1px solid transparent;
    border-radius: 8px;
    background: #fff;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s ease;
    min-width: 100px;
    justify-content: center;

    img {
      width: 16px;
      height: 16px;
    }

    &--edit {
      border-color: $primary-color;
      color: $primary-color;

      &:hover,
      &:focus {
        background: $primary-color;
        color: #fff;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba($primary-color, 0.3);

        img {
          filter: brightness(0) invert(1); // Macht das Icon weiß
        }
      }
    }

    &--delete {
      border-color: #e74c3c;
      color: #e74c3c;

      &:hover,
      &:focus {
        background: #e74c3c;
        color: #fff;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(#e74c3c, 0.3);

        img {
          filter: brightness(0) invert(1); // Macht das Icon weiß
        }
      }
    }

    &:focus {
      outline: 2px solid #4589ff;
      outline-offset: 2px;
    }
  }
}

// === Add/Edit Contact Overlay ===
.add-contact-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.08);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;

  // Desktop: Über der gesamten verfügbaren Fläche zentrieren
  @media (min-width: 1024px) {
    left: 240px;
    width: calc(100vw - 240px);
    background: rgba(0, 0, 0, 0.12); // Etwas dunkler für Desktop
  }
}

.add-contact {
  &__card {
    background: #fff;
    border-radius: 24px;
    width: 90vw;
    max-width: 400px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.18);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;

    // Desktop: Modernes, größeres Modal
    @media (min-width: 1024px) {
      width: 520px;
      max-width: 520px;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15), 0 8px 24px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);

      // Animierte Einblendung mit Scale-Effekt
      animation: modalSlideInDesktop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
  }

  &__header {
    position: relative;
    width: 100%;
    background: $primary-color;
    color: #fff;
    display: flex;
    align-items: center;
    flex-direction: column;
    padding: 16px 24px 64px 24px;
    font-size: 28px;
    font-weight: 700;

    // Desktop: Moderneres Header-Design
    @media (min-width: 1024px) {
      padding: 24px 32px 72px 32px;
      background: linear-gradient(
        135deg,
        $primary-color 0%,
        $primary-hover 100%
      );

      &::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
          circle at 30% 20%,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        pointer-events: none;
      }
    }
  }

  &__title {
    font-size: 28px;
    font-weight: 700;
    position: relative;
    z-index: 1;

    // Desktop: Größerer Titel
    @media (min-width: 1024px) {
      font-size: 32px;
      margin-bottom: 8px;
    }
  }

  &__subtitle {
    color: #fff;
    font-size: 16px;
    font-weight: 400;
    position: relative;
    z-index: 1;
    opacity: 0.9;

    // Desktop: Bessere Typografie
    @media (min-width: 1024px) {
      font-size: 18px;
      font-weight: 300;
      letter-spacing: 0.5px;
    }
  }

  &__close {
    position: absolute;
    top: 16px;
    right: 32px;
    background: none;
    border: none;
    color: #fff;
    cursor: pointer;
    z-index: 2;

    // Desktop: Größerer, prominenterer Close-Button
    @media (min-width: 1024px) {
      top: 20px;
      right: 48px;
      padding: 8px;
      border-radius: 8px;
      transition: all 0.2s ease;

      &:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: scale(1.1);
      }

      &:active {
        transform: scale(0.95);
      }
    }

    img {
      width: 18px;
      height: 18px;
      padding: 4px;
      border-radius: 50%;
      transition: all 0.2s ease;

      // Desktop: Größeres Icon
      @media (min-width: 1024px) {
        width: 20px;
        height: 20px;
        padding: 0;
      }

      &:hover {
        background-color: #ffffff3e;
      }
    }
  }

  &__avatar {
    width: 72px;
    height: 72px;
    border-radius: 50%;
    background: #f1f1f1;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: -48px auto 16px auto;
    border: 4px solid #fff;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    position: relative;
    z-index: 2;
    font-size: 24px;
    font-weight: 700;
    color: #fff;
    transition: all 0.3s ease;

    // Desktop: Größerer, beeindruckenderer Avatar
    @media (min-width: 1024px) {
      width: 96px;
      height: 96px;
      margin: -60px auto 24px auto;
      border: 6px solid #fff;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      background: linear-gradient(135deg, #f1f1f1 0%, #e1e1e1 100%);

      &:hover {
        transform: scale(1.05);
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
      }
    }

    img {
      width: 50px;
      height: 50px;
      object-fit: contain;

      // Desktop: Größeres Icon
      @media (min-width: 1024px) {
        width: 64px;
        height: 64px;
      }
    }
  }

  &__form {
    width: 90%;
    padding: 0 24px 24px 24px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;

    // Desktop: Mehr Platz und bessere Spacing
    @media (min-width: 1024px) {
      width: 85%;
      padding: 0 32px 32px 32px;
      gap: 20px;
    }
  }

  &__input-group {
    position: relative;
    width: 100%;
    display: flex;
    align-items: center;
    background: transparent;
    border: none;
    border-bottom: 2px solid #d1d1d1;
    border-radius: 0;
    padding: 0;
    margin-bottom: 0;
    transition: all 0.3s ease;

    // Desktop: Modernere Input-Felder
    @media (min-width: 1024px) {
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      padding: 4px;
      margin-bottom: 8px;

      &:hover {
        border-color: $primary-hover;
        background: #f1f3f4;
      }

      &:focus-within {
        border-color: $primary-color;
        background: #fff;
        box-shadow: 0 0 0 3px rgba(69, 137, 255, 0.1);
      }
    }

    input {
      width: 100%;
      padding: 12px 40px 12px 16px;
      border: none;
      border-bottom: none;
      font-size: 1rem;
      font-weight: 400;
      background: transparent;
      transition: all 0.3s ease;
      outline: none;

      // Desktop: Verbesserte Input-Styles
      @media (min-width: 1024px) {
        padding: 16px 48px 16px 20px;
        font-size: 16px;
        border-radius: 8px;

        &:focus {
          transform: translateY(-1px);
        }
      }

      &::placeholder {
        color: #b5bac5;
        opacity: 1;

        // Desktop: Dezentere Placeholder
        @media (min-width: 1024px) {
          color: #9ca3af;
          font-weight: 300;
        }
      }

      &:focus {
        border-bottom: 2px solid $primary-hover;

        // Desktop: Kein Border-Bottom Fokus
        @media (min-width: 1024px) {
          border-bottom: none;
        }
      }
    }

    .input-icon {
      position: absolute;
      right: 0;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      align-items: center;
      height: 24px;
      width: 24px;
      transition: all 0.2s ease;

      // Desktop: Bessere Icon-Positionierung
      @media (min-width: 1024px) {
        right: 8px;
        height: 32px;
        width: 32px;
        border-radius: 8px;

        &:hover {
          background: rgba(69, 137, 255, 0.1);
        }
      }

      img {
        width: 18px;
        height: 18px;
        opacity: 0.7;
        object-fit: contain;
        pointer-events: none;
        transition: all 0.2s ease;

        // Desktop: Größere Icons
        @media (min-width: 1024px) {
          width: 20px;
          height: 20px;
          opacity: 0.6;
        }
      }
    }
  }

  &__submit {
    width: min-content;
    background: $primary-hover;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 8px 8px;
    font-size: 14px;
    font-weight: 400;
    text-wrap: nowrap;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.2s;

    &:hover {
      background: $primary-color;
      transform: translateY(-1px);
      box-shadow: $shadow-medium;
    }

    &:active {
      transform: translateY(0);
      box-shadow: $shadow-light;
    }

    // Desktop: Größerer Button
    @media (min-width: 1024px) {
      padding: 12px 16px;
      font-size: 16px;
      font-weight: 600;
    }
  }
}

.edit__avatar {
  color: #fff;
  font-size: 24px;
  font-weight: 700;
}

.fab-menu-wrapper {
  position: fixed;
  right: 24px;
  bottom: 24px;
  z-index: 100;

  // Desktop: Komplett ausblenden, da großer Add-Button in der Liste vorhanden ist
  @media (min-width: 1024px) {
    display: none;
  }

  .contacts__fab {
    z-index: 101;
  }

  .contact-menu {
    position: absolute;
    right: 28px;
    bottom: 122px;
    background: #fff;
    border-radius: 20px 20px 4px 20px;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.13);
    padding: 18px 24px 14px 24px;
    display: flex;
    flex-direction: column;
    gap: 18px;
    min-width: 140px;
    z-index: 102;
  }
}

// === Modal Animations ===
@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes modalSlideInDesktop {
  0% {
    opacity: 0;
    transform: translateY(-30px) scale(0.9);
  }
  60% {
    opacity: 0.8;
    transform: translateY(5px) scale(1.02);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
